//--------------------------------------------------------------------------------------------------
/**
 * Implementation of the main menu screen.
 *
 * Copyright (C) Sierra Wireless Inc.
 */
//--------------------------------------------------------------------------------------------------

#include "cmdLine.h"
#include "mainMenu.h"
#include "ledScreen.h"
#include "buzzerScreen.h"
#include "octaveScreen.h"
#include "instantGratification.h"

//--------------------------------------------------------------------------------------------------
/**
 * Handle the "LEDs" menu option selection.
 */
//--------------------------------------------------------------------------------------------------
static void HandleLedsSelection
(
    void* contextPtr
)
//--------------------------------------------------------------------------------------------------
{
    ledScreen_Enter();
}


//--------------------------------------------------------------------------------------------------
/**
 * Handle the "Buzzer" menu option selection.
 */
//--------------------------------------------------------------------------------------------------
static void HandleBuzzerSelection
(
    void* contextPtr
)
//--------------------------------------------------------------------------------------------------
{
    buzzerScreen_Enter();
}

//--------------------------------------------------------------------------------------------------
/**
 * Handle the "Octave" menu option selection.
 */
//--------------------------------------------------------------------------------------------------
static void HandleOctaveSelection
(
    void* contextPtr
)
//--------------------------------------------------------------------------------------------------
{
    octaveScreen_Enter();
}


//--------------------------------------------------------------------------------------------------
/**
 * Handle selection of "Enable out-of-box experience".
 */
//--------------------------------------------------------------------------------------------------
static void EnableOutOfBoxExperience
(
    void* contextPtr
)
//--------------------------------------------------------------------------------------------------
{
    instantGratification_Enable();
    cmdLine_Refresh();
}


//--------------------------------------------------------------------------------------------------
/**
 * Handle selection of "Disable out-of-box experience".
 */
//--------------------------------------------------------------------------------------------------
static void DisableOutOfBoxExperience
(
    void* contextPtr
)
//--------------------------------------------------------------------------------------------------
{
    instantGratification_Disable();
    cmdLine_Refresh();
}


//--------------------------------------------------------------------------------------------------
/**
 * Draw the main menu.
 */
//--------------------------------------------------------------------------------------------------
static void DrawMainMenu
(
    void
)
//--------------------------------------------------------------------------------------------------
{
    printf("Welcome to mangOH Yellow!\n");

    cmdLine_MenuMode();

    if (instantGratification_IsEnabled())
    {
        cmdLine_AddMenuEntry("DISABLE out-of-box experience", DisableOutOfBoxExperience, NULL);
    }
    else
    {
        cmdLine_AddMenuEntry("ENABLE out-of-box experience", EnableOutOfBoxExperience, NULL);
    }

    cmdLine_AddMenuEntry("LEDs", HandleLedsSelection, NULL);
    cmdLine_AddMenuEntry("Buzzer", HandleBuzzerSelection, NULL);
    cmdLine_AddMenuEntry("Octave", HandleOctaveSelection, NULL);
}


//--------------------------------------------------------------------------------------------------
/**
 * Leave the main menu.
 */
//--------------------------------------------------------------------------------------------------
static void Leave
(
    void
)
//--------------------------------------------------------------------------------------------------
{
    // No place to go but back to the shell.
    cmdLine_Exit();
}


//--------------------------------------------------------------------------------------------------
/**
 * The Screen object for the main menu.
 */
//--------------------------------------------------------------------------------------------------
static Screen_t MainMenu =
{
    .drawFunc = DrawMainMenu,
    .leaveFunc = Leave,
    .title = "MAIN MENU"
};


//--------------------------------------------------------------------------------------------------
/**
 * Initialize the main menu screen.
 */
//--------------------------------------------------------------------------------------------------
void mainMenu_Init
(
    void
)
//--------------------------------------------------------------------------------------------------
{
    // No initialization necessary.
}


//--------------------------------------------------------------------------------------------------
/**
 * Enter the main menu screen.
 */
//--------------------------------------------------------------------------------------------------
void mainMenu_Enter
(
    void
)
//--------------------------------------------------------------------------------------------------
{
    cmdLine_SetCurrentScreen(&MainMenu);
}
